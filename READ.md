Algorithm originally by Dr. Aaron Montag.
